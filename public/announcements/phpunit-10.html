<!DOCTYPE html>
<html lang="en">
 <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="../css/bootstrap.min.css" type="text/css" rel="stylesheet">
  <link href="../css/highlight.min.css" rel="stylesheet">
  <link href="../css/style.css" type="text/css" rel="stylesheet">
  <title>Release Announcement for Version 10 of PHPUnit &#x2013; The PHP Testing Framework</title>
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="theme-color" content="#ffffff">
 </head>
 <body>
  <nav class="navbar navbar-expand-md navbar-light bg-light sticky-top">
   <div class="container">
    <div class="d-sm-flex d-md-none flex-row-reverse w-100">
     <button class="navbar-toggler float-right" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
     </button>
    </div>

    <div class="collapse navbar-collapse navbar-nav-justified" id="navbarSupportedContent">
     <a href="../index.html"><img alt="PHPUnit" src="../img/phpunit.svg" style="height: 40px;"/></a>
     <ul class="navbar-nav w-100 nav-justified">
      <li class="nav-item"><a class="nav-link" href="../documentation.html">Documentation</a></li>
      <li class="nav-item"><a class="nav-link" href="../support.html">Support</a></li>
      <li class="nav-item"><a class="nav-link" href="../sponsors.html">Sponsors</a></li>
      <li class="nav-item"><a class="nav-link" href="../contribute.html">Contribute</a></li>
     </ul>
    </div>
   </div>
  </nav>
  <div class="container">
   <div class="row">
    <div class="col-md-12">
     <h1><span style="white-space: nowrap;">PHPUnit 10</span></h1>
     <h4>February 3, 2023</h4>

     <p class="wrapped">
      The PHPUnit development team is pleased to announce the immediate availability of <span style="white-space: nowrap;">PHPUnit 10</span>.
      This release adds new features, modifies and removes existing functionality, and fixes bugs.
     </p>
     <p class="wrapped">
      <span style="white-space: nowrap;">PHPUnit 10</span> was scheduled to be released on February 5, 2021.
      Due to various reasons, including a pandemic, this was simply not possible. This does not mean that
      nothing has been achieved since <span style="white-space: nowrap;">PHPUnit 9</span> was released
      in February 2020. Quite the opposite, especially "under the hood".
     </p>
     <p class="wrapped">
      <span style="white-space: nowrap;">PHPUnit 10</span> is the most significant release in the history of the
      PHPUnit project (<a href="https://thephp.cc/presentations/phpunit-past-present-future">which began 23 years ago</a>).
      This release is to PHPUnit what <span style="white-space: nowrap;">PHP 7</span>
      was to PHP: a massive cleanup, refactoring, and modernisation that lays the groundwork for future development.
     </p>
     <p class="wrapped">
      A detailed list of changes can be found <a href="https://github.com/sebastianbergmann/phpunit/blob/10.0.0/ChangeLog-10.0.md#1000---2023-02-03">here</a>.
      The most significant changes are discussed below.
     </p>
     <h2>OMGWTFBBQ? I must upgrade to <span style="white-space: nowrap;">PHPUnit 10</span> immediately!</h2>
     <p class="wrapped">
      <strong>No, you do not.</strong>
     </p>
     <p class="wrapped">
      Just because <span style="white-space: nowrap;">PHPUnit 10</span> has been released today does not mean that
      <span style="white-space: nowrap;">PHPUnit 8</span> or <span style="white-space: nowrap;">PHPUnit 9</span>
      will no longer work. While old versions of PHPUnit will eventually stop receiving bug fixes,
      <a href="../supported-versions.html">we will keep them compatible with new versions of PHP for as long as
       possible</a>.
     </p>
     <p class="wrapped">
      We sincerely hope that you do not use the <a href="https://thephp.cc/articles/the-death-star-version-constraint">Death Star Version Constraint</a>
      and therefore do not automatically and unintentionally upgrade to a new major version of PHPUnit.
     </p>
     <p class="wrapped">
      Upgrading a dependency to a new major release must be a conscious decision that is part of a defined process.
      This process should include, at a minimum, reading an announcement like this and the
      <a href="https://github.com/sebastianbergmann/phpunit/blob/10.0.0/ChangeLog-10.0.md#1000---2023-02-03">ChangeLog</a>.
     </p>
     <p class="wrapped">
      <span style="white-space: nowrap;">PHPUnit 10</span> requires <span style="white-space: nowrap;">PHP 8.1</span> or later.
      If you are not using <span style="white-space: nowrap;">PHP 8.1</span> or <span style="white-space: nowrap;">PHP 8.2</span>,
      you will not be able to use <span style="white-space: nowrap;">PHPUnit 10</span> right away.
     </p>
     <hr/>
     <blockquote>
      <p class="wrapped">
       Need more reasons to upgrade your PHP?
      </p>
      <p class="wrapped">
       <a href="https://thephp.cc/articles/php-7-security-support-ends-now-what">Security support for <span style="white-space: nowrap;">PHP 7</span> ended in November 2022</a>,
       and so did the <a href="https://secure.php.net/supported-versions.php">active support for <span style="white-space: nowrap;">PHP 8.0</span>.</a> The only actively supported versions of PHP as of February 3, 2023 are <span style="white-space: nowrap;">PHP 8.1</span> and <span style="white-space: nowrap;">PHP 8.2</span>.
      </p>
     </blockquote>
     <hr/>
     <p class="wrapped">
      Also note that <a href="https://github.com/sebastianbergmann/php-code-coverage/blob/10.0.0/ChangeLog.md#1000---2023-02-03">PHPDBG
      and <span style="white-space: nowrap;">Xdebug 2</span> are no longer supported sources of code coverage information</a>.
      You now need either PCOV or <span style="white-space: nowrap;">Xdebug 3</span> to collect, process, and report code coverage
      information.
     </p>
     <p class="wrapped">
      We are confident that <span style="white-space: nowrap;">PHPUnit 10</span> works as intended, but in some respects
      it works differently than previous versions. For example, functionality marked as deprecated in
      <span style="white-space: nowrap;">PHPUnit 9</span> has been removed in <span style="white-space: nowrap;">PHPUnit 10</span>.
      You should not even try to upgrade to <span style="white-space: nowrap;">PHPUnit 10</span> if you cannot run your test suite
      with <span style="white-space: nowrap;">PHPUnit 9.6</span> without getting deprecation warnings.
     </p>
     <p class="wrapped">
      If you use a third-party test double library such as Prophecy, for instance, you will need to either rewrite your tests
      or wait for a version of the third-party test double library you use that is compatible with <span style="white-space: nowrap;">PHPUnit 10</span>.
      The out-of-the-box support for Prophecy in PHPUnit was deprecated in <span style="white-space: nowrap;">PHPUnit 9</span>
      and has now been removed for <span style="white-space: nowrap;">PHPUnit 10</span>.
     </p>
     <p class="wrapped">
      If you use a third-party extension for PHPUnit's test runner then you will have to wait for a version of the
      third-party extension that is compatible with <span style="white-space: nowrap;">PHPUnit 10</span>. The vendors of such extensions need to migrate their
      code from the old <code>TestListener</code> and <code>Hook</code> systems to the new event system.
     </p>
     <p class="wrapped">
      If you use a tool such as Infection or ParaTest that wraps PHPUnit's test runner then you will have to wait for a
      version of that tool that is compatible with <span style="white-space: nowrap;">PHPUnit 10</span>. The same holds true for alternative test runners such
      as Pest.
     </p>
     <p class="wrapped">
      Please note that the documentation has not been updated for <span style="white-space: nowrap;">PHPUnit 10</span>
      yet. We are in the process of reviewing, updating, and in some cases rewriting the documentation for
      <span style="white-space: nowrap;">PHPUnit 10</span>. We do this chapter by chapter and hope to complete this
      task soon.
     </p>
     <p class="wrapped">
      If the above points do not put you off, then please: go ahead and upgrade! And if you do encounter a problem,
      <a href="https://github.com/sebastianbergmann/phpunit/issues/new/choose">please report it</a>.
     </p>
     <hr/>
     <blockquote>
      <p class="wrapped">
       It has taken <a href="https://sebastian-bergmann.de/">Sebastian Bergmann</a> thousands
       of hours to develop, test, and support PHPUnit.
      </p>
      <p class="wrapped">
       Perhaps now is the time to <a href="../contribute.html">contribute
       to the development of PHPUnit</a> or <a href="../sponsors.html">sponsor Sebastian's work</a>.
      </p>
     </blockquote>
     <hr/>
     <p class="wrapped">
      Apart from functionality that was deprecated in <span style="white-space: nowrap;">PHPUnit 9</span>
      and that has now been removed in <span style="white-space: nowrap;">PHPUnit 10</span>, most of the changes
      are "under the hood" and should not affect end users. However, they do affect developers of extensions
      and/or wrappers around PHPUnit's test runner, such as Infection, ParaTest or Pest.
     </p>
     <p class="wrapped">
      These changes were necessary to make life easier for those working on PHPUnit and to allow for the
      development of new features in the future.
     </p>
     <h3>Event System</h3>
     <p class="wrapped">
      Previous versions of PHPUnit provided the <code>TestListener</code> interface as well as the
      <code>TestHook</code> interfaces for developers of extensions for PHPUnit's test runner. Both of
      these approaches for extending PHPUnit's test runner had <a href="https://github.com/sebastianbergmann/phpunit/issues/4676">severe drawbacks</a>.
      <span style="white-space: nowrap;">PHPUnit 10</span> replaces the <code>TestListener</code> and
      <code>TestHook</code> interfaces with an event system: (almost) everything is an event now.
      All output, both to the console and to log files, is now based on events.
     </p>
     <p class="wrapped">
      The development of this event system has been led by <a href="https://thephp.cc/company/consultants/arne-blankerts">Arne Blankerts</a>
      and <a href="https://localheinz.com/">Andreas Möller</a>. It was started at the
      <a href="https://github.com/eufossa/eu-hackathon-2019/blob/master/achievements/phpunit.md">EU-FOSSA Cyber Security Hackathon</a>
      in October 2019, together with <a href="https://thephp.cc/company/consultants/stefan-priebsch">Stefan Priebsch</a>
      and Ewout Pieter den Ouden.
     </p>
     <hr/>
     <blockquote>
      <p style="text-align: center;">
       <img alt="Arne Blankerts, Andreas Möller, and Ewout Pieter den Ouden work on the new event system for PHPUnit" src="../img/arne-andreas-ewout.jpg"/>
      </p>
      <p style="text-align: center;">
       Photo: Arne Blankerts, Andreas Möller, and Ewout Pieter den Ouden work on the new event system for PHPUnit
      </p>
     </blockquote>
     <hr/>
     <p class="wrapped">
      Following the best practice of "eating your own dog food", we refactored (and in some cases rewrote)
      PHPUnit's internal code that used to use the <code>TestListener</code> interface and <code>ResultPrinter</code>
      classes to use the event system instead. By forcing ourselves to use events for all output, to the console as
      well as to logfiles, we discovered many confusing and/or missing events early on.
     </p>
     <p class="wrapped">
      The new event system is not only superior to the previous <code>TestListener</code> and <code>Hook</code> approaches.
      The work on the event system had a ripple effect throughout PHPUnit's entire codebase. A lot of technical debt was
      finally paid off. Finding the right places to emit the right events revealed countless previously hidden
      inconsistencies and problems.
     </p>
     <p class="wrapped">
      For example, for the <code>TestRunner\Configured</code> event, we needed a canonical and immutable representation
      of the configuration. As a result, the code that loads the XML configuration is now better. And the code that handles
      the CLI arguments is better. And most importantly, the code that combines these two configuration sources into
      "the configuration" is now better. Once we had "the configuration", we realised that we could now implement large parts
      of the CLI test runner much more easily. This allowed us to clean up other parts, and so on and so forth.
     </p>
     <p class="wrapped">
      The event system is "read only". Developers can write extensions for PHPUnit's test runner and subscribe to events.
      The <code>Event</code> objects passed to subscribers as well as any value object aggregated in such an <code>Event</code>
      object is immutable.
     </p>
     <p class="wrapped">
      We regret that <span style="white-space: nowrap;">PHPUnit 10</span> and its new event system require significant changes
      to extensions for and/or wrappers around PHPUnit's test runner. We are confident that in the long run, the developers of
      such extensions or wrappers will appreciate the benefits of the new event system over its predecessors.
     </p>
     <p class="wrapped">
      The feedback we have received so far is very promising: Already in October 2021,
      <a href="https://github.com/sebastianbergmann/phpunit/issues/4807#issuecomment-953671212">Nuno Maduro</a>
      informed us that the migration of Pest from the old test listeners to the new event system was a "great" experience.
      The discussions we had with <a href="https://github.com/sebastianbergmann/phpunit/issues/4993">Filippo Tessarotto</a>
      were crucial in ensuring that solutions like ParaTest can be updated to work with <span style="white-space: nowrap;">PHPUnit 10</span>.
     </p>
     <p class="wrapped">
      The <a href="https://docs.phpunit.de/en/10.0/extending-phpunit.html#phpunit-s-event-system">documentation</a>
      for the new event system is not yet as complete or as understandable as we would like it to be. In the meantime,
      this <a href="https://thephp.cc/presentations/phpunit-10-the-new-event-subsystem">video</a> of a presentation
      from 2021 gives a good overview of the concepts and ideas behind the new event system. Keep in mind that some details
      have changed since then. This <a href="https://thephp.cc/presentations/phpunit-10-why-it-is-delayed-and-what-it-brings">presentation</a>
      from 2022 is more up to date and also sheds some light on why <span style="white-space: nowrap;">PHPUnit 10</span>
      was delayed, but unfortunately we do not have a video of it.
     </p>
     <h3>Test Outcome versus Test Issues</h3>
     <p class="wrapped">
      <span style="white-space: nowrap;">PHPUnit 10</span> introduces a clear separation between the <em>outcome</em> (errored, failed, incomplete, skipped, or passed)
      of a test and the <em>issues</em> (considered risky, triggered a warning, ...) of a test.
     </p>
     <p class="wrapped">
      The error handler of <span style="white-space: nowrap;">PHPUnit 9</span> (optionally) converted <code>E_(USER_)WARNING</code>, <code>E_(USER_)NOTICE</code>,
      <code>E_(USER_)DEPRECATED</code>, etc. to exceptions. These exceptions aborted the execution of a test and made
      PHPUnit consider the test to have errored.
     </p>
     <p class="wrapped">
      The error handler of <span style="white-space: nowrap;">PHPUnit 10</span> no longer converts <code>E_(USER_)WARNING</code>, <code>E_(USER_)NOTICE</code>,
      <code>E_(USER_)DEPRECATED</code>, etc. to exceptions. Therefore, the execution of a test is no longer aborted
      when an <code>E_USER_NOTICE</code> is triggered, for instance. Consequently, such a test is no longer considered
      to have errored.
     </p>
     <p class="wrapped">
      The example shown below triggers an <code>E_USER_NOTICE</code> during the execution of a test:
     </p>
    </div>
   </div>
   <div class="row">
    <div class="col-md-6">
     <pre><code>&lt;?php declare(strict_types=1);
use PHPUnit\Framework\TestCase;

final class ExampleTest extends TestCase
{
    public function testSomething(): void
    {
        $example = new Example;

        $this->assertTrue($example->doSomething());
    }

    public function testSomethingElse(): void
    {
        $example = new Example;

        $this->assertFalse($example->doSomething());
    }
}</code></pre>
    </div>
    <div class="col-md-6">
     <pre><code>&lt;?php declare(strict_types=1);
final class Example
{
    public function doSomething(): bool
    {
        // ...

        trigger_error('message', E_USER_NOTICE);

        // ...

        return false;
    }
}





</code></pre>
    </div>
   </div>
   <div class="row">
    <div class="col-md-6">
     <p class="wrapped"><strong><span style="white-space: nowrap;">PHPUnit 10</span></strong> does not convert the <code>E_USER_NOTICE</code> into an exception and the execution of the test is therefore not aborted:</p>
    </div>
    <div class="col-md-6">
     <p class="wrapped"><strong>PHPUnit 9</strong> converted the <code>E_USER_NOTICE</code> into an exception and the execution of the test was aborted:</p>
    </div>
   </div>
   <div class="row">
    <div class="col-md-6">
     <pre><strong>➜ php phpunit-10.0.phar --display-notices ExampleTest.php</strong>
<span style="white-space: nowrap;">PHPUnit 10</span>.0.0 by Sebastian Bergmann and contributors.

Runtime:       PHP 8.2.2

FN                                        2 / 2 (100%)

Time: 00:00.015, Memory: 6.00 MB

There was 1 failure:

1) ExampleTest::testSomething
Failed asserting that false is true.

/path/to/ExampleTest.php:10

--

There were 2 notices:

1) ExampleTest::testSomething
message

/path/to/ExampleTest.php:6

2) ExampleTest::testSomethingElse
message

/path/to/ExampleTest.php:13

FAILURES!
Tests: 2, Assertions: 2, Failures: 1, Notices: 2.</pre>
    </div>
    <div class="col-md-6">
     <pre><strong>➜ php phpunit-9.6.phar --verbose ExampleTest.php</strong>
PHPUnit 9.6.0 by Sebastian Bergmann and contributors.

Runtime:       PHP 8.2.2

EE                                        2 / 2 (100%)

Time: 00:00.015, Memory: 6.00 MB

There were 2 errors:

1) ExampleTest::testSomething
message

/path/to/Example.php:8
/path/to/ExampleTest.php:10

2) ExampleTest::testSomethingElse
message

/path/to/Example.php:8
/path/to/ExampleTest.php:17

ERRORS!
Tests: 2, Assertions: 0, Errors: 2.







</pre>
    </div>
   </div>
   <div class="row">
    <div class="col-md-12">
     <p class="wrapped">
      This means that using PHP functionality which triggers <code>E_DEPRECATED</code>, <code>E_NOTICE</code>,
      <code>E_STRICT</code>, or <code>E_WARNING</code> or calling code which triggers <code>E_USER_DEPRECATED</code>,
      <code>E_USER_NOTICE</code>, or <code>E_USER_WARNING</code> can no longer hide a bug in your code. In the example
      shown above, the line of code with the assertion is never reached when <span style="white-space: nowrap;">PHPUnit 9</span> is used and the code under
      test triggers <code>E_USER_NOTICE</code>.
     </p>
     <p class="wrapped">
      PHPUnit's test runner does not display details about deprecations, notices, or warnings by default. You have to
      use the CLI options <code>--display-deprecations</code>, <code>--display-notices</code>, and <code>--display-warnings</code>
      (or their XML configuration file counterparts) when you want these details displayed.
     </p>
     <h3>Metadata</h3>
     <p class="wrapped">
      <span style="white-space: nowrap;">PHPUnit 10</span> introduces <a href="https://github.com/sebastianbergmann/phpunit/issues/4502">support for <span style="white-space: nowrap;">PHP 8</span> attributes
      for adding metadata to test classes and test methods as well as tested code units</a>. We could have made our lives
      easier here, if we had removed support for annotations in code comments at the same time. However, that was out of the
      question.
     </p>
     <p class="wrapped">
      The example on the left uses <span style="white-space: nowrap;">PHP 8 attributes</span> and the example on the right
      uses annotations in code comments:
     </p>
    </div>
   </div>
   <div class="row">
    <div class="col-md-6">
     <pre><code>&lt;?php declare(strict_types=1);
namespace vendor\project;

use PHPUnit\Framework\TestCase;
use PHPUnit\Framework\Attributes\CoversClass;
use PHPUnit\Framework\Attributes\DataProvider;

#[CoversClass(Example::class)]
final class ExampleTest extends TestCase
{
    #[DataProvider('provider')]
    public function testSomething
    (string $expected, string $input): void
    {
        $example = new Example;

        $this->assertSame(
            $expected,
            $example->doSomething($input)
        );
    }

    public static function provider(): array
    {
        return [['foo', 'bar']];
    }
}</code></pre>
    </div>
    <div class="col-md-6">
     <pre><code>&lt;?php declare(strict_types=1);
namespace vendor\project;

use PHPUnit\Framework\TestCase;



/** @covers \vendor\project\Example */
final class ExampleTest extends TestCase
{
    /** @dataProvider provider */
    public function testSomething
    (string $expected, string $input): void
    {
        $example = new Example;

        $this->assertSame(
            $expected,
            $example->doSomething($input)
        );
    }

    public static function provider(): array
    {
        return [['foo', 'bar']];
    }
}</code></pre>
    </div>
   </div>
   <div class="row">
    <div class="col-md-12">
     <p class="wrapped">
      <span style="white-space: nowrap;">PHPUnit 10</span> still supports both old-fashioned annotations in code comments
      and modern attributes to attach metadata to code units. The two test classes shown above are treated the same by
      <span style="white-space: nowrap;">PHPUnit 10</span>.
     </p>
     <p class="wrapped">
      <span style="white-space: nowrap;">PHPUnit 10</span> looks for <span style="white-space: nowrap;">PHP 8 attributes</span>
      on a code unit first. It falls back to annotations in code comments when no <span style="white-space: nowrap;">PHP 8 attributes</span>
      are found on a code unit.
     </p>
     <p class="wrapped">
      Rector supports the <a href="https://github.com/rectorphp/rector-phpunit/blob/main/docs/rector_rules_overview.md">migration
      from annotations in comments to attributes in code</a>.
     </p>
     <h2>Getting <span style="white-space: nowrap;">PHPUnit 10</span></h2>
     <p class="wrapped">
      We distribute a <a href="https://secure.php.net/phar">PHP Archive (PHAR)</a> that contains everything you need in order to use PHPUnit.
      Alternatively, you may use Composer to download and install PHPUnit as well as its dependencies.
     </p>
     <p class="wrapped">
      <a href="../getting-started/phpunit-10.html">Here is a tutorial that gets you started.</a>
     </p>
     <h2>Supported Versions</h2>
     <p class="wrapped">
      Detailed information on supported versions of PHPUnit is available <a href="../supported-versions.html">here</a>.
      Below is a summary as of February 3, 2023:
     </p>
     <ul>
      <li><span style="white-space: nowrap;">PHPUnit 10</span> receives bug fixes until February 7, 2025</li>
      <li><span style="white-space: nowrap;">PHPUnit 9</span> receives bug fixes until February 2, 2024</li>
      <li><span style="white-space: nowrap;">PHPUnit 8</span> no longer receives bug fixes</li>
     </ul>
     <p class="wrapped">
      The versions listed above will be kept compatible with new PHP versions as long as possible.
     </p>
     <h2>Follow PHPUnit in the Fediverse</h2>
     <p class="wrapped">
      Consider following <a rel="me" href="https://phpc.social/@phpunit/">@phpunit@phpc.social</a> to stay up to date with PHPUnit's development.
     </p>
    </div>
   </div>
   <hr>
   <div class="footer">
    <p>Copyright &copy; Sebastian Bergmann.</p>
   </div>
  </div>
  <script type="text/javascript" src="../js/jquery.min.js"></script>
  <script type="text/javascript" src="../js/bootstrap.min.js"></script>
  <script src="../js/highlight.min.js"></script>
  <script src="../js/highlight.js"></script>
 </body>
</html>

